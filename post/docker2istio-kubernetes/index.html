<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>从docker到istio之三 - kubernetes集群编排 - 游戏不存在</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="shawn" /><meta name="description" content="前言 容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包" /><meta name="keywords" content="game, docker, kubernetes, python, go,  microservice" />






<meta name="generator" content="Hugo 0.54.0 with even 4.0.0" />
<meta name="google-site-verification" content="Qzk5S1WaeGv-bmDYA5rCo0HemniTpED_o5PAvmPp-yo" />


<link rel="canonical" href="https://game404.github.io/post/docker2istio-kubernetes/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="从docker到istio之三 - kubernetes集群编排" />
<meta property="og:description" content="前言 容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://game404.github.io/post/docker2istio-kubernetes/" />
<meta property="article:published_time" content="2019-05-22T22:39:33&#43;08:00"/>
<meta property="article:modified_time" content="2019-05-22T22:39:33&#43;08:00"/>

<meta itemprop="name" content="从docker到istio之三 - kubernetes集群编排">
<meta itemprop="description" content="前言 容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包">


<meta itemprop="datePublished" content="2019-05-22T22:39:33&#43;08:00" />
<meta itemprop="dateModified" content="2019-05-22T22:39:33&#43;08:00" />
<meta itemprop="wordCount" content="4367">



<meta itemprop="keywords" content="系列," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="从docker到istio之三 - kubernetes集群编排"/>
<meta name="twitter:description" content="前言 容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">游戏不存在</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">游戏不存在</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">从docker到istio之三 - kubernetes集群编排</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-05-22 </span>
        <div class="post-category">
            <a href="/categories/kubernetes/"> kubernetes </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#kubernetes">kubernetes</a></li>
<li><a href="#部署应用及测试">部署应用及测试</a>
<ul>
<li><a href="#编写应用部署文件">编写应用部署文件</a>
<ul>
<li><a href="#1-flaskapp文件-k8s-flaskapp-yaml">1. flaskapp文件<code>k8s/flaskapp.yaml</code></a></li>
<li><a href="#2-redis服务文件-k8s-redis-yaml">2. redis服务文件<code>k8s/redis.yaml</code></a></li>
<li><a href="#3-nginx服务文件-k8s-nginx-yaml">3. nginx服务文件<code>k8s/nginx.yaml</code></a></li>
</ul></li>
<li><a href="#部署应用到集群">部署应用到集群</a></li>
<li><a href="#访问应用">访问应用</a></li>
<li><a href="#扩容">扩容</a></li>
<li><a href="#清理">清理</a></li>
</ul></li>
<li><a href="#容器编排">容器编排</a>
<ul>
<li><a href="#节点标签">节点标签</a></li>
<li><a href="#节点污点">节点污点</a></li>
</ul></li>
<li><a href="#总结">总结</a></li>
<li><a href="#相关组件">相关组件</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h2 id="前言">前言</h2>

<p>容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包括下面四篇文章。</p>

<ul>
<li><a href="https://game404.github.io/post/docker2istio-docker/">从docker到istio之一 - 使用Docker将应用容器化</a></li>
<li><a href="https://game404.github.io/post/docker2istio-compose/">从docker到istio之二 - 使用compose部署应用</a></li>
<li><a href="https://game404.github.io/post/docker2istio-kubernetes/">从docker到istio之三 - kubernetes编排应用</a></li>
<li><a href="https://game404.github.io/post/docker2istio-istio/">从docker到istio之四 - istio管理应用</a></li>
</ul>

<p>这是第三篇，kubernetes编排应用。</p>

<h2 id="kubernetes">kubernetes</h2>

<blockquote>
<p>Kubernetes是一个开源的，用于管理云平台中多个主机上的容器化的应用，Kubernetes的目标是让部署容器化的应用简单并且高效（powerful）,Kubernetes提供了应用部署，规划，更新，维护的一种机制。</p>

<p>Kubernetes在希腊语中意思是船长或领航员，这也恰好与它在容器集群管理中的作用吻合，即作为装载了集装箱（Container）的众多货船的指挥者，负担着全局调度和运行监控的职责。因为Kubernetes在k和s之间有8个字母，所以又简称k8s</p>
</blockquote>

<p>快速体验k8s，可以使用Docker for mac中集成的k8s。</p>

<p><img src="https://game404-1251284600.cos.ap-beijing.myqcloud.com/docker-mac-kubernetes.png" alt="DockerForMac" /></p>

<p>启动k8s后，等待其初始化完成，然后 <code>docker ps</code> 可以看到k8s启动了一系列的容器:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></pre></td>
<td class="lntd">
<pre class="chroma">CONTAINER ID        IMAGE                            COMMAND                  CREATED             STATUS              PORTS               NAMES
17a693617137        docker/kube-compose-controller   &#34;/compose-controller…&#34;   3 days ago          Up 3 days                               k8s_compose_compose-74649b4db6-szsqz_docker_4f5997b7-5c47-11e9-95b9-025000000001_0
a9b666b48815        docker/kube-compose-api-server   &#34;/api-server --kubec…&#34;   3 days ago          Up 3 days                               k8s_compose_compose-api-5d754cdd89-ncwrq_docker_131b4d65-04e7-11e9-837c-025000000001_0
f4b05eefc73a        6f7f2dc7fab5                     &#34;/sidecar --v=2 --lo…&#34;   3 days ago          Up 3 days                               k8s_sidecar_kube-dns-86f4d74b45-zh6qc_kube-system_f669bc59-04e6-11e9-837c-025000000001_0
867f8f040258        c2ce1ffb51ed                     &#34;/dnsmasq-nanny -v=2…&#34;   3 days ago          Up 3 days                               k8s_dnsmasq_kube-dns-86f4d74b45-zh6qc_kube-system_f669bc59-04e6-11e9-837c-025000000001_0
17f26a6e91d2        80cc5ea4b547                     &#34;/kube-dns --domain=…&#34;   3 days ago          Up 3 days                               k8s_kubedns_kube-dns-86f4d74b45-zh6qc_kube-system_f669bc59-04e6-11e9-837c-025000000001_0

...</pre></td></tr></table>
</div>
</div>
<p><code>kubectl version</code> 查看集群版本:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">Client Version: version.Info{Major:&#34;1&#34;, Minor:&#34;10&#34;, GitVersion:&#34;v1.10.11&#34;, GitCommit:&#34;637c7e288581ee40ab4ca210618a89a555b6e7e9&#34;, GitTreeState:&#34;clean&#34;, BuildDate:&#34;2018-11-26T14:38:32Z&#34;, GoVersion:&#34;go1.9.3&#34;, Compiler:&#34;gc&#34;, Platform:&#34;darwin/amd64&#34;}
Server Version: version.Info{Major:&#34;1&#34;, Minor:&#34;10&#34;, GitVersion:&#34;v1.10.11&#34;, GitCommit:&#34;637c7e288581ee40ab4ca210618a89a555b6e7e9&#34;, GitTreeState:&#34;clean&#34;, BuildDate:&#34;2018-11-26T14:25:46Z&#34;, GoVersion:&#34;go1.9.3&#34;, Compiler:&#34;gc&#34;, Platform:&#34;linux/amd64&#34;}</pre></td></tr></table>
</div>
</div>
<p><code>kubectl get nodes</code> 查看k8s集群节点:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">NAME                 STATUS    ROLES     AGE       VERSION
docker-for-desktop   Ready     master    123d      v1.10.11</pre></td></tr></table>
</div>
</div>
<p><code>kubectl get service</code>查看k8s默认启动的服务:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP   123d</pre></td></tr></table>
</div>
</div>
<h2 id="部署应用及测试">部署应用及测试</h2>

<h3 id="编写应用部署文件">编写应用部署文件</h3>

<h4 id="1-flaskapp文件-k8s-flaskapp-yaml">1. flaskapp文件<code>k8s/flaskapp.yaml</code></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></pre></td>
<td class="lntd">
<pre class="chroma">apiVersion: v1
kind: Service
metadata:
  name: flaskapp
spec:
  ports:
    - port: 5000
  selector:
    name: flaskapp
---
apiVersion: extensions/v1beta1 
kind: Deployment
metadata:
  name: flaskapp
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: flaskapp
    spec:
      containers:
      - image: flaskapp:0.0.2
        name: flaskapp
        ports:
        - containerPort: 5000</pre></td></tr></table>
</div>
</div>
<p>了解这个部署文件，需要先大概了解一下k8s的运作方式。k8s通过api server提供restful接口，用于集群交互。每一个部署对象，都有<code>apiVersion</code>，<code>kind</code>, <code>metadata</code>, <code>spec</code>这几个关键字。</p>

<ul>
<li>定义了Service和Deployment2个类型的对象。Service表示k8s对外提供的服务，Deployment表示某个service的部署方式。</li>
<li>Service对象的ports描述了服务端口，这个是集群内部网络的端口。</li>
<li>Service对象的selector描述了服务如何选择对于的部署，采用标签<strong>name: flaskapp</strong>,这是一种解耦合的依赖关系。</li>
<li>Deployment的replicas描述了容器的副本个数，下文会演示如何扩充。</li>
<li>Deployment的containers描述了镜像名称，服务端口等。</li>
</ul>

<h4 id="2-redis服务文件-k8s-redis-yaml">2. redis服务文件<code>k8s/redis.yaml</code></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></pre></td>
<td class="lntd">
<pre class="chroma">apiVersion: v1
kind: Service
metadata:
  name: redis
spec:
  ports:
    - port: 6379
  selector:
    name: redis
---
apiVersion: extensions/v1beta1 
kind: Deployment
metadata:
  name: redis
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: redis
    spec:
      containers:
      - image: redis:4-alpine3.8
        name: redis
        ports:
        - containerPort: 6379</pre></td></tr></table>
</div>
</div>
<p>redis的部署文件和flaskapp的部署文件类似。</p>

<h4 id="3-nginx服务文件-k8s-nginx-yaml">3. nginx服务文件<code>k8s/nginx.yaml</code></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></pre></td>
<td class="lntd">
<pre class="chroma">kind: ConfigMap
apiVersion: v1
metadata:
  name: nginx-config
data:
  default.conf: |
    upstream flaskapp {
        server flaskapp:5000;
    }
    server {
        listen       80;
        server_name  localhost;

        root /usr/share/nginx/html;

        location / {
            proxy_pass http://flaskapp;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Host $host;
            proxy_redirect off;
        }

    }
---
apiVersion: v1
kind: Service
metadata:
  name: nginx
spec:
  ports:
    - port: 80
  selector:
    name: nginx
  type: NodePort
---
apiVersion: extensions/v1beta1 
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: nginx
    spec:
      containers:
      - image: nginx:1.15.8-alpine
        name: nginx
        ports:
        - containerPort: 80
        volumeMounts:
          - name: nginx-config-volume
            mountPath: /etc/nginx/conf.d/default.conf
            subPath: default.conf
      volumes:
        - name: nginx-config-volume
          configMap:
            name: nginx-config</pre></td></tr></table>
</div>
</div>
<p>nginx的部署文件，变化在:</p>

<ul>
<li>多出了ConfigMap对象，这个对象主要定义了nginx.conf文件，其内容和<code>nginx\default.conf</code>一致。</li>
<li>nginx的container中mount了一个configmap对象作为nginx的配置文件。</li>
</ul>

<h3 id="部署应用到集群">部署应用到集群</h3>

<p>使用<code>kubectl apply -f k8s</code>命令将编写yaml文件提交到k8s集群，集群会自动根据yaml文件的声明，进行部署。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">service &#34;flaskapp&#34; created
deployment.extensions &#34;flaskapp&#34; created
configmap &#34;nginx-config&#34; created
service &#34;nginx&#34; created
deployment.extensions &#34;nginx&#34; created
service &#34;redis&#34; created
deployment.extensions &#34;redis&#34; created</pre></td></tr></table>
</div>
</div>
<blockquote>
<p>这里的<code>kubectl apply -f k8s</code> 表示将k8s目录下的文件都提交给k8s集群。当然，也可以逐个文件提交 <code>kubectl apply -f k8s/redis.yaml</code> 。</p>
</blockquote>

<h3 id="访问应用">访问应用</h3>

<p>先<code>kubectl get service</code>检查一下k8s内的服务:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
flaskapp     ClusterIP   10.110.202.47    &lt;none&gt;        5000/TCP       31s
kubernetes   ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP        123d
nginx        NodePort    10.100.233.149   &lt;none&gt;        80:30457/TCP   31s
redis        ClusterIP   10.106.55.214    &lt;none&gt;        6379/TCP       31s</pre></td></tr></table>
</div>
</div>
<p>注意nginx服务部分的PORTS为<strong>80:30457/TCP</strong>,这表示将容器的80端口暴露到本机网络的30457端口，和我们之前的docker启动时候的<code>-p 80:80</code>参数类似。</p>

<p>服务是由Pod提供的，继续检查一下pods的状况<code>kubectl get pods</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">NAME                        READY     STATUS    RESTARTS   AGE
flaskapp-6c4fccdf99-v6w2v   1/1       Running   0          2m
nginx-85fb469b96-lr982      1/1       Running   0          2m
redis-5b44bb8d97-wwmll      1/1       Running   0          2m</pre></td></tr></table>
</div>
</div>
<p>当然，也可以直接查看docker的容器<code>docker ps</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">➜  docker2istio docker ps
CONTAINER ID        IMAGE                            COMMAND                  CREATED             STATUS              PORTS               NAMES
ad7377ae7196        ae70b17240ec                     &#34;docker-entrypoint.s…&#34;   About an hour ago   Up About an hour                        k8s_redis_redis-5b44bb8d97-wwmll_default_2907f4a3-6639-11e9-b8cb-025000000001_0
c01108b49076        1a61773c4c07                     &#34;python flaskapp.py&#34;     About an hour ago   Up About an hour                        k8s_flaskapp_flaskapp-6c4fccdf99-xcmwb_default_28fbe1b1-6639-11e9-b8cb-025000000001_0
11d1fa3f182b        315798907716                     &#34;nginx -g &#39;daemon of…&#34;   About an hour ago   Up About an hour                        k8s_nginx_nginx-85fb469b96-lr982_default_28fbdeee-6639-11e9-b8cb-025000000001_0
c28032a4b068        k8s.gcr.io/pause-amd64:3.1       &#34;/pause&#34;                 About an hour ago   Up About an hour                        k8s_POD_redis-5b44bb8d97-wwmll_default_2907f4a3-6639-11e9-b8cb-025000000001_0
7091657acfbc        k8s.gcr.io/pause-amd64:3.1       &#34;/pause&#34;                 About an hour ago   Up About an hour                        k8s_POD_flaskapp-6c4fccdf99-xcmwb_default_28fbe1b1-6639-11e9-b8cb-025000000001_0
97007670c247        k8s.gcr.io/pause-amd64:3.1       &#34;/pause&#34;                 About an hour ago   Up About an hour                        k8s_POD_nginx-85fb469b96-lr982_default_28fbdeee-6639-11e9-b8cb-025000000001_0
...</pre></td></tr></table>
</div>
</div>
<blockquote>
<p><strong><em>!!!注意:</em></strong> pod并不等同于docker的容器，Pod才是k8s操作的最小单元。简单的说，一个Pod可能包含多个容器，从yaml文件中<strong>containers:</strong>这个关键字可以看出。仔细观察<code>docker ps</code>的输出，可以发现每个pod除了用户自定义的容器外，还有镜像为<strong>k8s.gcr.io/pause-amd64:3.1</strong>的系统容器。</p>
</blockquote>

<p>最后使用 <code>curl http://127.0.0.1:30457</code> 访问服务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">Hello World by 10.1.0.21 from 192.168.65.3 ! 该页面已被访问 1 次。</pre></td></tr></table>
</div>
</div>
<h3 id="扩容">扩容</h3>

<p>k8s集群下，扩容非常简单</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">➜  docker2istio kubectl edit deployment/flaskapp
deployment.extensions &#34;flaskapp&#34; edited</pre></td></tr></table>
</div>
</div>
<p>修改其中的** replicas: 3 **。</p>

<blockquote>
<p>也可以修改<code>k8s\flaskapp.yaml</code>中的值，然后<code>kubectl apply -f k8s\flaskapp.yaml</code></p>

<p>另外，如果镜像有更新，也是采用修改flaskapp.yaml文件然后apply的方式。</p>
</blockquote>

<p><code>kubectl get pods -o wide</code> 检查扩容结果, 这里使用了 <code>-o wide</code> ,可以显示更多信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">NAME                        READY     STATUS    RESTARTS   AGE       IP          NODE
flaskapp-6c4fccdf99-9xsjl   1/1       Running   0          3m        10.1.0.23   docker-for-desktop
flaskapp-6c4fccdf99-xcmwb   1/1       Running   0          1h        10.1.0.21   docker-for-desktop
flaskapp-6c4fccdf99-zp8mk   1/1       Running   0          3m        10.1.0.24   docker-for-desktop
nginx-85fb469b96-lr982      1/1       Running   0          1h        10.1.0.19   docker-for-desktop
redis-5b44bb8d97-wwmll      1/1       Running   0          1h        10.1.0.22   docker-for-desktop</pre></td></tr></table>
</div>
</div>
<p>多次访问服务:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">➜  docker2istio curl http://127.0.0.1:30457
Hello World by 10.1.0.21 from 192.168.65.3 ! 该页面已被访问 2 次。
➜  docker2istio curl http://127.0.0.1:30457
Hello World by 10.1.0.23 from 192.168.65.3 ! 该页面已被访问 3 次。
➜  docker2istio curl http://127.0.0.1:30457
Hello World by 10.1.0.24 from 192.168.65.3 ! 该页面已被访问 4 次。
➜  docker2istio curl http://127.0.0.1:30457</pre></td></tr></table>
</div>
</div>
<p>结合前面看到的flaskapp的IP，可以比较清晰的看到请求会自动负载到不同的Pod。</p>

<h3 id="清理">清理</h3>

<p>k8s下的容器清理也非常简单, 使用 <code>kubectl delete -f k8s</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">service &#34;flaskapp&#34; deleted
deployment.extensions &#34;flaskapp&#34; deleted
configmap &#34;nginx-config&#34; deleted
service &#34;nginx&#34; deleted
deployment.extensions &#34;nginx&#34; deleted
service &#34;redis&#34; deleted
deployment.extensions &#34;redis&#34; deleted</pre></td></tr></table>
</div>
</div>
<h2 id="容器编排">容器编排</h2>

<p>实际上，k8s集群在多集群情况下，会自动将Pod调度到合适的节点，这就是容器编排的概念。这种能力，主要有2个方式。</p>

<h3 id="节点标签">节点标签</h3>

<p>我们的k8s演示集群节点情况如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 k8s]$ kubectl get nodes
NAME            STATUS   ROLES    AGE    VERSION
192-168-10-14   Ready    &lt;none&gt;   13d    v1.14.0
192-168-10-18   Ready    &lt;none&gt;   130d   v1.14.0
192-168-10-21   Ready    master   131d   v1.14.0</pre></td></tr></table>
</div>
</div>
<p>部署示例应用到k8s演示集群:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl apply -f k8s -n docker2istio
service/flaskapp created
deployment.extensions/flaskapp created
configmap/nginx-config created
service/nginx created
deployment.extensions/nginx created
service/redis created
deployment.extensions/redis created</pre></td></tr></table>
</div>
</div>
<blockquote>
<p><strong><em>!!!注意</em></strong> 为了不和别的服务发生名称冲突，这里部署时候使用了 <code>-n docker2istio</code> 参数，创建了一个独立的名称空间。名称空间可以使用 <code>kubectl create namespace docker2istio</code> 命令创建。</p>
</blockquote>

<p>查看名称空间下的服务:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get service -n docker2istio
NAME       TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
flaskapp   ClusterIP   10.101.127.107   &lt;none&gt;        5000/TCP       47s
nginx      NodePort    10.103.147.187   &lt;none&gt;        80:30387/TCP   46s
redis      ClusterIP   10.106.162.13    &lt;none&gt;        6379/TCP       46s</pre></td></tr></table>
</div>
</div>
<p>查看名称空间下的pod:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get pods -o wide -n docker2istio
NAME                        READY   STATUS    RESTARTS   AGE   IP             NODE            NOMINATED NODE   READINESS GATES
flaskapp-589c4cdf86-sftr9   1/1     Running   0          81s   10.244.2.30    192-168-10-14   &lt;none&gt;           &lt;none&gt;
nginx-55b87f44ff-b4x88      1/1     Running   0          81s   10.244.2.31    192-168-10-14   &lt;none&gt;           &lt;none&gt;
redis-7fc7fc64fb-2nzjq      1/1     Running   0          81s   10.244.1.195   192-168-10-18   &lt;none&gt;           &lt;none&gt;</pre></td></tr></table>
</div>
</div>
<p>参考前文，修改副本数量参数<strong>replicas</strong>，对flaskapp进行扩容:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get pods -o wide -n docker2istio
NAME                        READY   STATUS    RESTARTS   AGE     IP             NODE            NOMINATED NODE   READINESS GATES
flaskapp-589c4cdf86-8jzwx   1/1     Running   0          4s      10.244.1.197   192-168-10-18   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-sftr9   1/1     Running   0          3m10s   10.244.2.30    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-tz98x   1/1     Running   0          4s      10.244.1.196   192-168-10-18   &lt;none&gt;           &lt;none&gt;
nginx-55b87f44ff-b4x88      1/1     Running   0          3m10s   10.244.2.31    192-168-10-14   &lt;none&gt;           &lt;none&gt;
redis-7fc7fc64fb-2nzjq      1/1     Running   0          3m10s   10.244.1.195   192-168-10-18   &lt;none&gt;           &lt;none&gt;</pre></td></tr></table>
</div>
</div>
<p>这里就可以看到，扩容完成后，flaskapp的3个pod会自动调度到<strong>192-168-10-18</strong>和<strong>192-168-10-18</strong>2个业务节点。</p>

<p>192-168-10-14节点的磁盘使用的是高速ssd，io性能会更好一些，我们希望redis能够调度到该节点。</p>

<p>首先，给192-168-10-14节点打上<code>storage=ssd</code>的标签:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl label nodes 192-168-10-14 storage=ssd
node/192-168-10-14 labeled</pre></td></tr></table>
</div>
</div>
<p>检查标签是否正常标记:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get nodes --show-labels | grep ssd
192-168-10-14   Ready    &lt;none&gt;   13d    v1.14.0   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=192-168-10-14,kubernetes.io/os=linux,storage=ssd</pre></td></tr></table>
</div>
</div>
<p>然后修改<code>k8s/redis.yaml</code>,增加<code>nodeSelector</code>数值，其值为<code>storage: ssd</code>, 修改完成的deployment如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></pre></td>
<td class="lntd">
<pre class="chroma">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: redis
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: redis
    spec:
      containers:
      - image: redis:4-alpine3.8
        name: redis
        ports:
        - containerPort: 6379
      nodeSelector:
        storage: ssd</pre></td></tr></table>
</div>
</div>
<p>使用<code>kubectl apply -f k8s/redis.yaml -n docker2istio</code>应用修改。查看docker2istio的pod分布情况:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get pods -o wide -n docker2istio
NAME                        READY   STATUS    RESTARTS   AGE   IP             NODE            NOMINATED NODE   READINESS GATES
flaskapp-589c4cdf86-8jzwx   1/1     Running   0          11m   10.244.1.197   192-168-10-18   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-sftr9   1/1     Running   0          14m   10.244.2.30    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-tz98x   1/1     Running   0          11m   10.244.1.196   192-168-10-18   &lt;none&gt;           &lt;none&gt;
nginx-55b87f44ff-b4x88      1/1     Running   0          14m   10.244.2.31    192-168-10-14   &lt;none&gt;           &lt;none&gt;
redis-66f66896b6-7666t      1/1     Running   0          4s    10.244.2.35    192-168-10-14   &lt;none&gt;           &lt;none&gt;</pre></td></tr></table>
</div>
</div>
<p>可见redis节点重新被调度到192-168-10-14节点，表现出了节点标签的亲和力。</p>

<h3 id="节点污点">节点污点</h3>

<p>在k8s演示集群中192-168-10-21是master节点，默认不会调度业务pod，这种能力是采用节点污点实现的。 取消192-168-10-21调度污点:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">kubectl taint node 192-168-10-21 node-role.kubernetes.io/master:NoSchedule-</pre></td></tr></table>
</div>
</div>
<p>然后扩容flaskapp的副本数到6个，观察pod分布情况:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get pods -o wide -n docker2istio
NAME                        READY   STATUS         RESTARTS   AGE     IP             NODE            NOMINATED NODE   READINESS GATES
flaskapp-589c4cdf86-8jzwx   1/1     Running        0          20m     10.244.1.197   192-168-10-18   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-92rm5   1/1     Running        0          5s      10.244.2.36    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-bfhs8   1/1     Running        0          5s      10.244.0.26    192-168-10-21   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-sftr9   1/1     Running        0          23m     10.244.2.30    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-srv25   1/1     Running        0          5s      10.244.0.25    192-168-10-21   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-tz98x   1/1     Running        0          20m     10.244.1.196   192-168-10-18   &lt;none&gt;           &lt;none&gt;
nginx-55b87f44ff-b4x88      1/1     Running        0          23m     10.244.2.31    192-168-10-14   &lt;none&gt;           &lt;none&gt;
redis-66f66896b6-7666t      1/1     Running        0          9m30s   10.244.2.35    192-168-10-14   &lt;none&gt;           &lt;none&gt;</pre></td></tr></table>
</div>
</div>
<p>这里可以看到，有2个pod被调到到192-168-10-21节点了。</p>

<p>重新设置污点:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl taint node 192-168-10-21 node-role.kubernetes.io/master=:NoSchedule
node/192-168-10-21 tainted</pre></td></tr></table>
</div>
</div>
<p>删除在192-168-10-21上的2个pod:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">kubectl delete pod/flaskapp-589c4cdf86-bfhs8 -n docker2istio
kubectl delete pod/flaskapp-589c4cdf86-srv25 -n docker2istio</pre></td></tr></table>
</div>
</div>
<p>观察pod分布情况:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></pre></td>
<td class="lntd">
<pre class="chroma">[tyhall51@192-168-10-21 docker2istio]$ kubectl get pods -o wide -n docker2istio
NAME                        READY   STATUS    RESTARTS   AGE     IP             NODE            NOMINATED NODE   READINESS GATES
flaskapp-589c4cdf86-8jzwx   1/1     Running   0          25m     10.244.1.197   192-168-10-18   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-92rm5   1/1     Running   0          4m40s   10.244.2.36    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-fp5w4   1/1     Running   0          73s     10.244.2.37    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-lv2ch   1/1     Running   0          73s     10.244.1.199   192-168-10-18   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-p9kb6   1/1     Running   0          7s      10.244.2.38    192-168-10-14   &lt;none&gt;           &lt;none&gt;
flaskapp-589c4cdf86-sftr9   1/1     Running   0          28m     10.244.2.30    192-168-10-14   &lt;none&gt;           &lt;none&gt;
nginx-55b87f44ff-b4x88      1/1     Running   0          28m     10.244.2.31    192-168-10-14   &lt;none&gt;           &lt;none&gt;
redis-66f66896b6-7666t      1/1     Running   0          14m     10.244.2.35    192-168-10-14   &lt;none&gt;           &lt;none&gt;</pre></td></tr></table>
</div>
</div>
<p>可以看到删除后的pod，在192-168-10-18和192-168-10-14这2个业务节点上重建了。</p>

<h2 id="总结">总结</h2>

<p>k8s相对于compose：</p>

<ol>
<li>管理规模扩大，由单机到集群。</li>
<li>扩容更方便了，可以无缝扩容。</li>
<li>部署策略更完善，可以对容器进行<strong>编排</strong>。</li>
</ol>

<h2 id="相关组件">相关组件</h2>

<ol>
<li>Etcd</li>
</ol>

<blockquote>
<p>etcd 是一个分布式键值对存储，设计用来可靠而快速的保存关键数据并提供访问。通过分布式锁，leader选举和写屏障(write barriers)来实现可靠的分布式协作。etcd集群是为高可用，持久性数据存储和检索而准备。k8s中使用etcd作为集群信息存储。</p>
</blockquote>

<ol>
<li>Efk</li>
</ol>

<blockquote>
<p>EFK (Elasticsearch + Fluentd + Kibana) 是kubernetes官方推荐的日志收集方案</p>
</blockquote>

<ol>
<li>helm</li>
</ol>

<blockquote>
<p>Helm helps you manage Kubernetes applications — Helm Charts help you define, install, and upgrade even the most complex Kubernetes application.</p>
</blockquote>

<ol>
<li>Rock</li>
</ol>

<blockquote>
<p>File, Block, and Object Storage Services for your Cloud-Native Environments</p>
</blockquote>

<p>&hellip;</p>

<p>&hellip;</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">shawn</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2019-05-22
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%B3%BB%E5%88%97/">系列</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/docker2istio-istio/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">从docker到istio之四 - istio管理应用</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/docker2istio-compose/">
            <span class="next-text nav-default">从docker到istio之二 - 使用compose部署应用</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="comments-gitment"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitment@0.0.3/style/default.min.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitment@0.0.3/dist/gitment.browser.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitment = new Gitment({
        id: '2019-05-22 22:39:33 \x2b0800 CST',
        title: '从docker到istio之三 - kubernetes集群编排',
        link: decodeURI(location.href),
        desc: '前言 容器化，云原生越演越烈，新概念非常之多。信息爆炸的同时，带来层层迷雾。我尝试从扩容出发理解其脉路，经过实践探索，整理形成一个入门教程，包',
        owner: 'game404',
        repo: 'game404.github.io',
        oauth: {
          client_id: '28a86ccaa3184b49dfc4',
          client_secret: '15ab0f7c1445c0afb5e3d7a8995c89f2fd081eb7'
        }
      });
      gitment.render('comments-gitment');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/imsun/gitment">comments powered by gitment.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:studyoo@foxmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/game404" class="iconfont icon-github" title="github"></a>
      <a href="https://juejin.im/user/593f44b8da2f60006736604e" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://game404.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">game404</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-137813525-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
